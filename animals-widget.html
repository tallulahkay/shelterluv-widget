<!DOCTYPE html>
<html lang="en">
<head>
  <meta charset="UTF-8">
  <meta name="viewport" content="width=device-width, initial-scale=1.0">
  <title>Animals Available for Adoption</title>
  <style>
    body {
      margin: 0;
      font-family: Arial, sans-serif;
    }

    .animals-container {
      display: grid;
      grid-template-columns: repeat(4, 1fr);
      gap: 20px;
      padding: 20px;
    }
    
    .animal-card {
      width: 100%;
      cursor: pointer;
    }
    
    .animal-card img {
      width: 100%;
      aspect-ratio: 1 / 1;
      object-fit: cover;
      border-radius: 4px;
      transition: transform 0.2s;
    }

    .animal-card img:hover {
      transform: scale(1.05);
    }
    
    .animal-card h3 {
      margin: 8px 0 0 0;
      font-size: 16px;
      text-align: center;
    }

    .pagination {
      display: flex;
      justify-content: center;
      align-items: center;
      gap: 10px;
      padding: 20px;
      flex-wrap: wrap;
    }

    .pagination button {
      padding: 10px 20px;
      border: 1px solid #ddd;
      background: white;
      border-radius: 4px;
      cursor: pointer;
      font-size: 14px;
    }

    .pagination button:hover:not(:disabled) {
      background: #f0f0f0;
    }

    .pagination button:disabled {
      opacity: 0.5;
      cursor: not-allowed;
    }

    .page-info {
      font-size: 14px;
      color: #666;
      text-align: center;
    }

    /* Tablet (3 columns) */
    @media (max-width: 1024px) {
      .animals-container {
        grid-template-columns: repeat(3, 1fr);
        gap: 15px;
        padding: 15px;
      }
      
      .animal-card h3 {
        font-size: 15px;
      }
    }

    /* Small tablet / large phone (2 columns) */
    @media (max-width: 768px) {
      .animals-container {
        grid-template-columns: repeat(2, 1fr);
        gap: 12px;
        padding: 12px;
      }
      
      .animal-card h3 {
        font-size: 14px;
      }

      .pagination button {
        padding: 8px 16px;
        font-size: 13px;
      }

      .page-info {
        font-size: 13px;
        width: 100%;
        margin-top: 8px;
      }
    }

    /* Mobile (1 column) */
    @media (max-width: 480px) {
      .animals-container {
        grid-template-columns: 1fr;
        gap: 15px;
        padding: 10px;
      }

      .animal-card {
        max-width: 400px;
        margin: 0 auto;
      }
      
      .animal-card h3 {
        font-size: 16px;
      }

      .pagination {
        padding: 15px 10px;
      }

      .pagination button {
        padding: 10px 16px;
      }
    }
  </style>
</head>
<body>
  <!-- List View -->
  <div id="list-view" class="list-view">
    <div id="animals" class="animals-container"></div>
    
    <div class="pagination">
      <button id="prevBtn" onclick="prevPage()">Previous</button>
      <span class="page-info" id="pageInfo"></span>
      <button id="nextBtn" onclick="nextPage()">Next</button>
    </div>
  </div>

  <script>
    let currentPage = 0;
    const itemsPerPage = 12;
    let allAnimals = [];

    // Helper function to normalize photos to array format
    function normalizePhotos(photos) {
      if (Array.isArray(photos)) {
        return photos;
      } else if (photos && typeof photos === 'object') {
        // Convert object to array
        return Object.values(photos);
      }
      return [];
    }

    async function getAnimals() {
      try {
        const response = await fetch('https://new.shelterluv.com/api/v3/available-animals/24538?animalType=Dog');
        
        const data = await response.json();
        allAnimals = data.animals;
        
        console.log('Full API Response:', data);
        console.log('Total Animals:', allAnimals.length);
        
        displayAnimals();
        updatePagination();
        
      } catch (error) {
        console.error('Error:', error);
        document.getElementById('animals').innerHTML = '<p>Error loading animals</p>';
      }
    }
    
    function displayAnimals() {
      const container = document.getElementById('animals');
      const start = currentPage * itemsPerPage;
      const end = start + itemsPerPage;
      const pageAnimals = allAnimals.slice(start, end);
      
      container.innerHTML = pageAnimals.map(animal => {
        // Normalize photos to array
        const photosArray = normalizePhotos(animal.photos);
        
        // Find the cover photo
        const coverPhoto = photosArray.find(p => p.isCover) || photosArray[0];
        const imageUrl = coverPhoto ? coverPhoto.url : '';
        
        return `
          <div class="animal-card" onclick="openAnimalDetail('${animal.public_url}', ${animal.nid})">
            ${imageUrl ? `<img src="${imageUrl}" alt="${animal.name}">` : ''}
            <h3>${animal.name}</h3>
          </div>
        `;
      }).join('');

      // Scroll container to top when new page loads
      container.scrollTop = 0;
    }

    function openAnimalDetail(publicUrl, nid) {
      // Find the animal in our data for logging
      const animal = allAnimals.find(a => a.nid === nid);
      
      if (animal) {
        // Log the full animal details
        console.log('Full Animal Details:', animal);
        console.log('Animal Name:', animal.name);
        console.log('Animal NID:', animal.nid);
        console.log('Unique ID:', animal.uniqueId);
        console.log('Public URL:', publicUrl);
      }
      
      // Open the embed page in a new tab
      window.open(publicUrl, '_blank');
    }

    function updatePagination() {
      const prevBtn = document.getElementById('prevBtn');
      const nextBtn = document.getElementById('nextBtn');
      const pageInfo = document.getElementById('pageInfo');

      const totalPages = Math.ceil(allAnimals.length / itemsPerPage);
      const start = currentPage * itemsPerPage + 1;
      const end = Math.min((currentPage + 1) * itemsPerPage, allAnimals.length);

      // Disable previous button if on first page
      prevBtn.disabled = currentPage === 0;
      
      // Disable next button if on last page
      nextBtn.disabled = currentPage >= totalPages - 1;

      // Update page info
      pageInfo.textContent = `Showing ${start}-${end} of ${allAnimals.length} animals (Page ${currentPage + 1} of ${totalPages})`;
    }

    function nextPage() {
      const totalPages = Math.ceil(allAnimals.length / itemsPerPage);
      if (currentPage < totalPages - 1) {
        currentPage++;
        displayAnimals();
        updatePagination();
      }
    }

    function prevPage() {
      if (currentPage > 0) {
        currentPage--;
        displayAnimals();
        updatePagination();
      }
    }
    
    // Load animals on initial load
    getAnimals();
  </script>
</body>

</html>


